/*
 ============================================================================
 Name        : TP1.c
 Author      : Escobar Juan Ignacio
 Version     :
 Copyright   : DIVISION F
 Description : Hello World in C, Ansi-style
 ============================================================================
 */

#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>

#define BTC 4606954.55

int mostrarMenu(void);
float opcionElegida(int,float vec[], float vecCostos1[], float vecCostos2[]);
int validarOpcion1a6(int);
int subMenuValorVuelo();
float cargarValorKM();
float ingresarKM();
float cargarCostos(int, float, float vec[]);

int main(void) {

	setbuf(stdout,NULL);

	//Para calcular todo necesito 3 datos, KM,$LATAM,$AA
	float vectorDatos[3];
	float vectorCostosLatam[5];
	float vectorCostosAA[5];

	int opcionSeleccionada;

	do{
	opcionSeleccionada = mostrarMenu();
	printf("RECEPCIONE OPCION SELECCIONADA %d", opcionSeleccionada);
	opcionElegida(opcionSeleccionada, vectorDatos, vectorCostosLatam, vectorCostosAA);

	}while(opcionSeleccionada !=6);

	return 0;
}

int mostrarMenu(){

	//El usuario debe elegir una opcion del menu general.
	int opcionElegida;

	printf("1- Ingresar KM. \n");
	printf("2- Ingresar valor del vuelo. \n");
	printf("3- Calcular costos. \n");
	printf("4- Mostrar datos de facturacion. \n");
	printf("5- Carga Manual de Datos. \n");
	printf("6- Salir. \n");

	//Tomamos el valor del usuario.
	printf("\n\nElija una opcion:   ");
	scanf("%d", &opcionElegida);
	opcionElegida = validarOpcion1a6(opcionElegida);
	printf("\n\n\n\n\n\n\n\n\n\n");

	return opcionElegida;

}


float opcionElegida(int opcion, float vectorDatos[], float costosAA[], float costosLatam[]){
	printf("\n LA OPCION ELEGIDA ES EL %d", opcion);
	printf("\nVOY A ENTRAR AL SWITCH");
	switch(opcion){
		printf("\nENTRE AL SWITCH");
		case 1:
			vectorDatos[0] = ingresarKM();
			return vectorDatos;
			break;
		case 2:
			//submenu precioAereolinea (AA o LATAM)
			int opcionSubmenu;
			opcionSubmenu = subMenuValorVuelo();

			if(opcionSubmenu==1){
				vectorDatos[1] = cargarValorKM();
				return vectorDatos;
			}else{
				vectorDatos[2] = cargarValorKM();
				return vectorDatos;
			}

			break;
		case 3:
			//calcular todos los costos segun caso.
			for(int i = 0; i<sizeof(costosAA);i++){
				costosLatam[i] = cargarCostos(i,vectorDatos[0],vectorDatos[1]);
				costosAA[i] = cargarCostos(i,vectorDatos[0],vectorDatos[2]);

				if(i==4){
					costosLatam[4] = costosLatam[4]-costosAA[4];
					costosAA[4] = costosLatam[4];
				}
			}
			return vectorDatos;
			break;
		case 4:
			print("\n\n\nLatam:");
			print("\nPrecio con tarjeta de débito: %2.f", costosLatam[0]);
			printf("\nPrecio con tarjeta de crédito: %2.f", costosLatam[1]);
			printf("\nPrecio pagando con bitcoin : %f", costosLatam[2]);
			printf("\nPrecio unitario: %2.f", costosLatam[3]);
			printf("\n\n\nAerolíneas: ");
			printf("\nPrecio con tarjeta de débito: %2.f", costosAA[0]);
			printf("\nPrecio con tarjeta de crédito: %2.f", costosAA[1]);
			printf("\nPrecio pagando con bitcoin : %f", costosAA[2]);
			printf("\nPrecio unitario: %2.f", costosAA[3]);
			printf("\n\n\nLa diferencia de precio es : %2.f ", costosAA[4]);
			break;
		case 5:
			break;
		case 6:
			char revalidacion;
			printf("\n\a\nESTAS SEGURO DE SALIR DEL PROGRAMA Y/N :");
			fflush(stdin);
			scanf('%c', revalidacion);
			revalidacion = tolower(revalidacion);
			while(revalidacion != 'y' || revalidacion != 'n'){
				printf("Error de dato valido. Reingrese Y/N: ");
				fflush(stdin);
				scanf('%c', revalidacion);
				revalidacion = tolower(revalidacion);
			}
			break;
	}
	return vectorDatos;
}

int validarOpcion1a6(int opcion){
	printf("\nENTRE A VALIDAR LA OPCION 1 A 6");
	while(opcion>6 || opcion<1){
		printf("\a\n\nElija una opcion correcta:   ");
		scanf("%d", &opcion);
	}
	printf("\nOPCION VALIDADA PUEDE CONTINUAR");
	return opcion;
}

int subMenuValorVuelo(){
	int opcionElegida;

	printf("1- LATAM. \n");
	printf("2- Aereolineas Argentinas. \n");

	//Tomamos el valor del usuario.
	printf("\n\nElija una opcion:   ");
	scanf("%d", &opcionElegida);

	while(opcionElegida>2 || opcionElegida<1){
			printf("\a\n\nElija una opcion correcta:   ");
			scanf("%d", &opcionElegida);
		}

		return opcionElegida;

}

float ingresarKM(){
	float kilometros;

		printf("n\nIngrese el valor del KM    $");
		scanf("%.2f", &kilometros);

		while(kilometros<1){
			printf("n\nIngrese valor de kilometros valido  ");
			scanf("%.2f", &kilometros);
		}

		return kilometros;
}

float cargarValorKM(){
	float precio;

	printf("n\nIngrese el valor del KM    $");
	scanf("%.2f", &precio);

	while(precio<1){
		printf("n\nIngrese un precio valido del KM    $");
		scanf("%.2f", &precio);
	}

	return precio;
}

float cargarCostos(int indice, float km, float valorVuelo){
	float valorFinal;

	 switch(indice){
	 case 0:
		 valorFinal = valorVuelo*0.90*km;
		 break;
	 case 1:
		 valorFinal = valorVuelo*1.25*km;
		 break;
	 case 2:
		 valorFinal = (valorVuelo/BTC)*km;
		 break;
	 case 3:
		 valorFinal = valorVuelo*km;
		 break;
	 case 4:
		 valorFinal = valorVuelo*km;
		 break;
	 }

	return valorFinal;
}
